<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/view/sequences/Filters.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/view/sequences/Filters.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Author: Jongil Yoon &lt;jiysait@gmail.com>
 */
import _ from "lodash";
import { useCallback, useReducer, useState } from "react";

import {
  Accordion,
  Menu,
  Label,
  Checkbox,
  Segment,
  Input,
  Grid,
  Icon,
} from "semantic-ui-react";

/**
 * Search Tool
 */
function Search(props) {
  const { setRowData } = props;

  const initialSearchState = {
    loading: false,
    searchValue: "",
  };

  function searchReducer(state, action) {
    switch (action.searchType) {
      case "CLEAN_QUERY":
        return initialSearchState;
      case "START_SEARCH":
        return { ...state, loading: true, searchValue: action.searchQuery };
      case "FINISH_SEARCH":
        return { ...state, loading: false, searchValue: action.searchQuery };
      case "NOT_FOUND":
        return { ...state, loading: false };

      default:
        throw new Error();
    }
  }

  const [searchState, dispatchSearch] = useReducer(
    searchReducer,
    initialSearchState
  );
  const { searchValue } = searchState;

  const handleSearchChange = useCallback((e, data) => {
    dispatchSearch({ searchType: "START_SEARCH", searchQuery: data.value });
    if (data.value.length === 0) {
      dispatchSearch({ searchType: "CLEAN_QUERY" });
      setRowData({
        type: "SET_HISTORY",
        module: "search",
        search: "",
      });
      setRowData({
        type: "APPLY_HISTORY",
      });
      return;
    }

    dispatchSearch({
      searchType: "FINISH_SEARCH",
      searchQuery: data.value,
    });
    setRowData({
      type: "SET_HISTORY",
      module: "search",
      search: data.value,
    });
    setRowData({
      type: "APPLY_HISTORY",
    });
  }, []);

  return (
    &lt;Input
      onChange={handleSearchChange}
      value={searchValue}
      icon="search"
      placeholder="Search..."
      type="text"
    />
  );
}

export default function Filters(props) {
  const { rowData, setRowData, wideView, setWideView } = props;
  const { ORIGIN } = rowData;

  const [activeIndex, setActiveIndex] = useState({
    0: false,
    1: false,
    2: false,
    3: false,
    4: false,
  });

  const handleClick = (e, data) => {
    const { index, active } = data;
    setActiveIndex({ ...activeIndex, [index]: !active });
  };

  const handleChange = (e, data) => {
    // Temporary
    setRowData({
      type: "SET_HISTORY",
      module: "search",
      search: data.value,
    });
    setRowData({
      type: "APPLY_HISTORY",
    });
  };

  const statisticRef = ORIGIN.slice();

  // alias names are hardcoded. it needs to be fixed in the future
  const organism = _.countBy(
    statisticRef.map((row) => row.data["sample.organism"]).sort()
  );
  const instrument = _.countBy(
    statisticRef.map((row) => row.data["experiment.instrument"]).sort()
  );
  const platform = _.countBy(
    statisticRef.map((row) => row.data["experiment.platform"]).sort()
  );
  const libraryLayout = _.countBy(
    statisticRef.map((row) => row.data["experiment.libraryLayout"]).sort()
  );
  const librarySource = _.countBy(
    statisticRef.map((row) => row.data["experiment.librarySource"]).sort()
  );

  const OrganismForm = (
    &lt;Grid className="ebs-filters-submenu">
      {organism &amp;&amp;
        Object.keys(organism).map((key, index) => {
          return (
            &lt;Grid.Row key={index}>
              &lt;Grid.Column>
                &lt;Checkbox
                  className="ebs-inverted"
                  label={key}
                  name="sample.organism"
                  value={key}
                  onChange={handleChange}
                />
              &lt;/Grid.Column>
              &lt;Grid.Column width={2} floated="right">
                &lt;Label color="grey">{organism[key]}&lt;/Label>
              &lt;/Grid.Column>
            &lt;/Grid.Row>
          );
        })}
    &lt;/Grid>
  );

  const InstrumentForm = (
    &lt;Grid className="ebs-filters-submenu">
      {instrument &amp;&amp;
        Object.keys(instrument).map((key, index) => {
          return (
            &lt;Grid.Row key={index}>
              &lt;Grid.Column>
                &lt;Checkbox
                  className="ebs-inverted"
                  label={key}
                  name="experiment.instrument"
                  value={key}
                  onChange={handleChange}
                />
              &lt;/Grid.Column>
              &lt;Grid.Column width={2} floated="right">
                &lt;Label color="grey">{instrument[key]}&lt;/Label>
              &lt;/Grid.Column>
            &lt;/Grid.Row>
          );
        })}
    &lt;/Grid>
  );

  const PlatformForm = (
    &lt;Grid className="ebs-filters-submenu">
      {platform &amp;&amp;
        Object.keys(platform).map((key, index) => {
          return (
            &lt;Grid.Row key={index}>
              &lt;Grid.Column>
                &lt;Checkbox
                  className="ebs-inverted"
                  label={key}
                  name="experiment.platform"
                  value={key}
                  onChange={handleChange}
                />
              &lt;/Grid.Column>

              &lt;Grid.Column width={2} floated="right">
                &lt;Label color="grey">{platform[key]}&lt;/Label>
              &lt;/Grid.Column>
            &lt;/Grid.Row>
          );
        })}
    &lt;/Grid>
  );

  const LibraryLayoutForm = (
    &lt;Grid className="ebs-filters-submenu">
      {libraryLayout &amp;&amp;
        Object.keys(libraryLayout).map((key, index) => {
          return (
            &lt;Grid.Row key={index}>
              &lt;Grid.Column>
                &lt;Checkbox
                  className="ebs-inverted"
                  label={key}
                  name="experiment.libraryLayout"
                  value={key}
                  onChange={handleChange}
                />
              &lt;/Grid.Column>

              &lt;Grid.Column width={2} floated="right">
                &lt;Label color="grey">{libraryLayout[key]}&lt;/Label>
              &lt;/Grid.Column>
            &lt;/Grid.Row>
          );
        })}
    &lt;/Grid>
  );

  const LibrarySourceForm = (
    &lt;Grid className="ebs-filters-submenu">
      {librarySource &amp;&amp;
        Object.keys(librarySource).map((key, index) => {
          return (
            &lt;Grid.Row key={index}>
              &lt;Grid.Column>
                &lt;Checkbox
                  className="ebs-inverted"
                  label={key}
                  name="experiment.librarySource"
                  value={key}
                  onChange={handleChange}
                />
              &lt;/Grid.Column>

              &lt;Grid.Column width={2} floated="right">
                &lt;Label color="grey">{librarySource[key]}&lt;/Label>
              &lt;/Grid.Column>
            &lt;/Grid.Row>
          );
        })}
    &lt;/Grid>
  );

  return wideView ? (
    &lt;Grid
      verticalAlign="middle"
      centered
      padded
      className="ebs-left-side-as-button-frame"
      onClick={() => {
        setWideView(!wideView);
      }}
    >
      &lt;Grid.Row>
        &lt;Grid.Column className="ebs-paddingless">
          &lt;Icon name="angle double right" />
        &lt;/Grid.Column>
      &lt;/Grid.Row>
    &lt;/Grid>
  ) : (
    &lt;>
      &lt;Segment inverted>
        &lt;Search setRowData={setRowData} />
      &lt;/Segment>
      &lt;div className="ebs-scrollable-inner">
        &lt;Accordion inverted fluid as={Menu} vertical>
          &lt;Menu.Item>
            &lt;Accordion.Title
              active={activeIndex[0]}
              content="Organism"
              index={0}
              onClick={handleClick}
            />
            &lt;Accordion.Content active={activeIndex[0]} content={OrganismForm} />
          &lt;/Menu.Item>

          &lt;Menu.Item>
            &lt;Accordion.Title
              active={activeIndex[1]}
              content="Instrument"
              index={1}
              onClick={handleClick}
            />
            &lt;Accordion.Content
              active={activeIndex[1]}
              content={InstrumentForm}
            />
          &lt;/Menu.Item>

          &lt;Menu.Item>
            &lt;Accordion.Title
              active={activeIndex[2]}
              content="Platform"
              index={2}
              onClick={handleClick}
            />
            &lt;Accordion.Content active={activeIndex[2]} content={PlatformForm} />
          &lt;/Menu.Item>

          &lt;Menu.Item>
            &lt;Accordion.Title
              active={activeIndex[3]}
              content="Library Layout"
              index={3}
              onClick={handleClick}
            />
            &lt;Accordion.Content
              active={activeIndex[3]}
              content={LibraryLayoutForm}
            />
          &lt;/Menu.Item>

          &lt;Menu.Item>
            &lt;Accordion.Title
              active={activeIndex[4]}
              content="Library Source"
              index={4}
              onClick={handleClick}
            />
            &lt;Accordion.Content
              active={activeIndex[4]}
              content={LibrarySourceForm}
            />
          &lt;/Menu.Item>
        &lt;/Accordion>
      &lt;/div>
      &lt;Segment inverted>
        &lt;Menu.Item
          onClick={() => {
            setWideView(!wideView);
          }}
        >
          &lt;Grid columns={2}>
            &lt;Grid.Row>
              &lt;Grid.Column>Wide View&lt;/Grid.Column>
              &lt;Grid.Column textAlign="right">
                &lt;Icon name="angle double left" />
              &lt;/Grid.Column>
            &lt;/Grid.Row>
          &lt;/Grid>
        &lt;/Menu.Item>
      &lt;/Segment>
    &lt;/>
  );
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#ColumnSelector">ColumnSelector</a></li><li><a href="global.html#CUSTOM_FIELDS">CUSTOM_FIELDS</a></li><li><a href="global.html#getSchemeDefault">getSchemeDefault</a></li><li><a href="global.html#Home">Home</a></li><li><a href="global.html#PageSizeSelector">PageSizeSelector</a></li><li><a href="global.html#Search">Search</a></li><li><a href="global.html#Sequences">Sequences</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Thu Jul 15 2021 07:17:42 GMT-0600 (미 산지 하계 표준시)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
