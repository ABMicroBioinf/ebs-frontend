<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/table/EBSTableTools.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/table/EBSTableTools.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Author: Jongil Yoon &lt;jiysait@gmail.com>
 */
import { useCallback, useState } from "react";
import { CSVLink } from "react-csv";

import {
  Menu,
  Segment,
  Pagination,
  Button,
  Dropdown,
  Grid,
  Icon,
  Modal,
  Header,
  Table,
  TableBody,
} from "semantic-ui-react";

/**
 * Column Selector
 */
function ColumnSelector(props) {
  const { columnData, setRowData } = props;

  const handleChange = useCallback((e) => {
    setRowData({
      type: "SET_HISTORY",
      module: "columns",
      column: e.currentTarget.value,
    });
    setRowData({
      type: "APPLY_HISTORY",
    });
  }, []);

  return (
    &lt;Grid columns={5}>
      {columnData &amp;&amp;
        columnData.map((column, index) => (
          &lt;Grid.Column key={index}>
            &lt;input
              disabled={column.primary}
              label={column.value}
              value={column.value}
              onChange={handleChange}
              defaultChecked={column.display}
              type="checkbox"
            />
            &lt;label>{column.value}&lt;/label>
          &lt;/Grid.Column>
        ))}
    &lt;/Grid>
  );
}

/**
 * Page Selector
 */
function PageSizeSelector(props) {
  const { pageSize, setRowData } = props;

  const pageSizeOptions = [
    { key: 1, text: "5", value: 5 },
    { key: 2, text: "10", value: 10 },
    { key: 3, text: "20", value: 20 },
    { key: 4, text: "50", value: 50 },
    { key: 5, text: "100", value: 100 },
  ];

  const handlePageSizeChange = useCallback(
    (e, data) => {
      setRowData({
        type: "SET_HISTORY",
        page: 1,
        pageSize: data.value,
      });
      setRowData({
        type: "APPLY_HISTORY",
      });
    },
    [pageSize]
  );

  return (
    &lt;>
      &lt;label>Show &lt;/label>
      &lt;Menu compact>
        &lt;Dropdown
          onChange={handlePageSizeChange}
          text={pageSize.toString()}
          options={pageSizeOptions}
          compact
          selection
        />
      &lt;/Menu>
      &lt;label> rows&lt;/label>
    &lt;/>
  );
}

export default function EBSTableTools(props) {
  const { tableTitle, columnData, rowData, setRowData } = props;
  const { ORIGIN, history, dataset } = rowData;
  const { pagination } = history;
  const { page, pageSize, pageCount } = pagination;

  const [activeItem, setActiveItem] = useState("");
  const [openAlert, setOpenAlert] = useState(false);

  const handleExport = useCallback(() => {
    setOpenAlert(!openAlert);
  }, []);

  const handleItemClick = useCallback(
    (e, { name }) => {
      name === activeItem ? setActiveItem("") : setActiveItem(name);
    },
    [activeItem]
  );

  const handlePageChange = useCallback(
    (e, data) => {
      setRowData({
        type: "SET_HISTORY",
        page: data.activePage,
      });
      setRowData({
        type: "APPLY_HISTORY",
      });
    },
    [page]
  );

  const handleSubmenuClose = useCallback((e) => {
    e.preventDefault();
    setActiveItem("");
  }, []);

  const handleRefresh = useCallback((e) => {
    e.preventDefault();
    setRowData({
      type: "RESET_DATASET",
    });
    setRowData({
      type: "APPLY_HISTORY",
    });
  }, []);

  const getSubmenu = useCallback(() => {
    switch (activeItem) {
      case "page":
        return &lt;PageSizeSelector pageSize={pageSize} setRowData={setRowData} />;

      case "columns":
        return (
          &lt;ColumnSelector
            columnData={columnData}
            rowData={rowData}
            setRowData={setRowData}
          />
        );

      default:
        return null;
    }
  }, [activeItem, pageSize, columnData, rowData]);

  return (
    &lt;>
      &lt;Menu attached="top" tabular fluid>
        &lt;Menu.Item>
          &lt;Button onClick={handleExport}>Export as CSV&lt;/Button>
        &lt;/Menu.Item>
        &lt;Menu.Item>
          &lt;Pagination
            secondary
            totalPages={pageCount}
            onPageChange={handlePageChange}
            boundaryRange={0}
            defaultActivePage={1}
            ellipsisItem={null}
            firstItem={null}
            lastItem={null}
            siblingRange={1}
          />
        &lt;/Menu.Item>

        &lt;Menu.Menu position="right">
          &lt;Menu.Item>
            {(() => {
              return (
                "Showing " +
                (
                  (Number(page) - 1) * Number(pageSize) +
                  (dataset.length > 0 ? 1 : 0)
                ).toString() +
                " - " +
                (Number(pageSize) > dataset.length
                  ? ORIGIN.length
                  : Number(page) * Number(pageSize)
                ).toString() +
                " of " +
                ORIGIN.length
              );
            })()}
          &lt;/Menu.Item>

          &lt;Menu.Item>
            &lt;Button icon basic onClick={handleRefresh}>
              &lt;Icon name="refresh" />
            &lt;/Button>
          &lt;/Menu.Item>

          &lt;Menu.Item
            name="page"
            active={activeItem === "page"}
            onClick={handleItemClick}
          />
          &lt;Menu.Item
            name="columns"
            active={activeItem === "columns"}
            onClick={handleItemClick}
          />
        &lt;/Menu.Menu>
      &lt;/Menu>

      &lt;Segment hidden={activeItem === ""} attached="bottom">
        {getSubmenu()}
        &lt;Button
          circular
          floated="right"
          size="mini"
          icon="close"
          onClick={handleSubmenuClose}
        />
      &lt;/Segment>

      &lt;Modal
        onClose={() => setOpenAlert(false)}
        onOpen={() => setOpenAlert(true)}
        open={openAlert}
        size="small"
      >
        &lt;Modal.Header>Export as CSV&lt;/Modal.Header>
        &lt;Modal.Content>
          &lt;Modal.Description>
            &lt;Header>Selection Details&lt;/Header>
            &lt;Table celled padded>
              &lt;Table.Header>
                &lt;Table.Row>
                  &lt;Table.HeaderCell singleLine>Rows selected&lt;/Table.HeaderCell>
                  &lt;Table.HeaderCell singleLine>Filename&lt;/Table.HeaderCell>
                &lt;/Table.Row>
              &lt;/Table.Header>
              &lt;TableBody>
                &lt;Table.Row>
                  &lt;Table.Cell>
                    &lt;Header as="h2" textAlign="center">
                      {ORIGIN.filter((obj) => obj.isSelected).length}
                    &lt;/Header>
                  &lt;/Table.Cell>
                  &lt;Table.Cell singleLine>{`${tableTitle}.csv`}&lt;/Table.Cell>
                &lt;/Table.Row>
              &lt;/TableBody>
            &lt;/Table>
          &lt;/Modal.Description>
        &lt;/Modal.Content>
        &lt;Modal.Actions>
          &lt;Button color="red" onClick={() => setOpenAlert(false)}>
            Cancel
          &lt;/Button>
          &lt;div
            className={`ui green button ebs-custom-csv-export ${
              ORIGIN.filter((obj) => obj.isSelected).length > 0
                ? ""
                : "disabled"
            }`}
          >
            &lt;CSVLink
              data={ORIGIN.filter((obj) => obj.isSelected).map(
                (obj) => obj.data
              )}
              filename={`${tableTitle}.csv`}
            >
              Export
            &lt;/CSVLink>
          &lt;/div>
        &lt;/Modal.Actions>
      &lt;/Modal>
    &lt;/>
  );
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#ColumnSelector">ColumnSelector</a></li><li><a href="global.html#CUSTOM_FIELDS">CUSTOM_FIELDS</a></li><li><a href="global.html#getSchemeDefault">getSchemeDefault</a></li><li><a href="global.html#Home">Home</a></li><li><a href="global.html#PageSizeSelector">PageSizeSelector</a></li><li><a href="global.html#Search">Search</a></li><li><a href="global.html#Sequences">Sequences</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Thu Jul 15 2021 07:17:42 GMT-0600 (미 산지 하계 표준시)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
